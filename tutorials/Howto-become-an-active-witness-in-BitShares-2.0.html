



<!doctype html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>&lt;no title&gt;</title>

    <!-- CSS -->
    <link  href='../_static/main.css' rel='stylesheet'>
    <link  href='../_static/style.css' rel='stylesheet'>
    <link  href='../_static/doxygen.css' rel='stylesheet'>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

    <!-- Sphinx search -->
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script src='../_static/script.js'></script>

    <!-- title card -->
    <link  href='../_static/title-card.css' rel='stylesheet'>
    <script src='../_static/title-card.js'></script>
    
    <!-- Sphinx search -->
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Graphene/BitShares 2.0 Technical Documentation  documentation"
          href="../_static/opensearch.xml"/>

    <!-- Meta -->
    <meta content="Graphene Documentation" property="og:site_name">
    <meta content="Graphene Documentation" property="og:title">
    <meta content="website" property="og:type">
    <meta content="Graphene Documentation" name="description">
    <meta content="Graphene Documentation" property="og:description">
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68381245-1', 'auto');
  ga('send', 'pageview');

</script>

 </head>
 <body class='no-literate'>

 <div class='title-area title-card' style='background-image: url(https://bitshares.org/images/bg.jpg)'>
   <div class='in'>
     <div class='headline'>
       <h1>Graphene/BitShares 2.0 Technical Documentation</h1>
       <p>&lt;no title&gt;</p>
       <p style="margin-top: 3em;"><img src="../_static/learn.svg" width="124" /><p>
     </div>
   </div>
 </div>

 <div class='header'>
   <div class='left'>
    
        <a class="uplink" href="../index.html">Contents</a>

   </div>
 </div>

 <div class='content-root'>
  <!-- menu bar -->
  <div class='menubar'>
   <div class='section'>
    <img src="../_static/grphn-logo.svg" width="48" />
       <!--<a class='big button' href='#' target='_blank'>Download</a>-->
   </div>
   <div class='menu section'>
    <div id="toc">
      <h3>Table Of Contents</h3>
      <ul class="simple">
</ul>

    </div>
   </div>
   <div class='bottom section'>
   <!--
     <a href='https://github.com/cryptonomex/graphene'>View on GitHub</a><br>
     <a href='https://github.com/cryptonomex/graphene/blob/master/README.md' target='_blank'>See .md source</a>
   -->
   </div>
  </div>
  <div class='content'>
   
  <p>This document serves as an introduction on how to become an actively block
producing witness in in the BitShares2.0 network. Please note that there
currently is no public testnet available, hence, this howto will fail at the
last few steps. However, we feel that we should inform interested parties about
how to prepare their machines for participation as witness as soon as possible.</p>
<p>We will have to import an existing account from the BitShares 0.9 network and
add some initial funds for the witness registration fee. After that, we will
create, configure and run a witness node.</p>
<p>## Preparations in BitShares 0.9 network</p>
<p>### Extracting an account from BitShares 0.9
To create a new account, you will need to start with an existing account with
some of the BTS asset that will pay the transaction fee registering your new
witness. Get your <cite>&lt;wif&gt;</cite> key from BitShares 0.9 via:</p>
<div class="highlight-python"><div class="highlight"><pre>BitShares0.9: &gt;&gt;&gt; wallet_dump_account_private_key &lt;accountname&gt; &quot;owner_key&quot;
&quot;5.....&quot;  # the &lt;owner wif key&gt;
</pre></div>
</div>
<p>### Extracting balances from BitShares 0.9
The key we have extracted previously only gives access to the registered name.
Hence, none of the accounts in the genesis block have balances in them. In the
first BitShares network, accounts were less tightly coupled to balances.
Balances were associated with public keys, and an account could have hundreds of
public keys with balances (or, conversely, public keys with balances could exist
without any account associated with them).</p>
<p>In order to get a witness registered we need to import approximately $120 worth of
BTS into the BitShares 2.0 client later.</p>
<p>#### Manually extracting private keys (most secure way)
We can extract the required private keys that hold funds this way. First we get
all balance ids from an account via::</p>
<div class="highlight-python"><div class="highlight"><pre>BitShares0.9: &gt;&gt;&gt; wallet_account_balance_ids &lt;accountname&gt;
[[
&quot;xeroc&quot;,[
  &quot;BTSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;,
  &quot;BTSBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB&quot;,
      ...
]
  ]
]
</pre></div>
</div>
<p>Each of these balances can be investigated via::</p>
<div class="highlight-python"><div class="highlight"><pre>BitShares0.9: &gt;&gt;&gt; blockchain_get_balance BTSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
....
&quot;asset_id&quot;: 0,                                     &lt;- asset_id (0: BTS)
&quot;data&quot;: {
  &quot;owner&quot;: &quot;BTSOOOOOOOOOOOOOOOOOOOOOOOOOOOOOWNER&quot;, &lt;- address
      ...
  &quot;balance&quot;: 0,                                        &lt;- balance
  ...
</pre></div>
</div>
<p>The required part (the owner of the balance) is denoted as <cite>owner</cite>.
Pick one or more address for BTS balances and dump the corresponding private key(s) with::</p>
<div class="highlight-python"><div class="highlight"><pre>BitShares0.9: &gt;&gt;&gt; wallet_dump_private_key BTSOOOOOOOOOOOOOOOOOOOOOOOOOOOOOWNER
&quot;5.......&quot; # the &lt;balance wif key&gt;
</pre></div>
</div>
<p>Note: Make sure to secure these private keys, as they are unencrypted and give
access to the funds in the BitShares 0.9 network. You may loose your money if
you are not an secure computer!</p>
<p>#### Scripted extraction with Python (requires code audit)
The following paragraphs will give an alternative (easier) way to dump the
relevant private keys using a python script. If you are comfortable with the
description above, you can safely skip the subsequent paragraph.</p>
<p>A Python script located at <a class="reference external" href="https://github.com/xeroc/bitshares-pytools/blob/master/tools/getbalancekeys.py">github</a>
may help you to retrieve private keys for your balances.
You need to modify the first few lines of the script in order to get a
connection to your BitShares daemon.:</p>
<div class="highlight-python"><div class="highlight"><pre>$ edit getbalancekeys.py
    [...]
config.url    = &quot;http://10.0.0.16:19988/rpc&quot;
config.user   = &#39;rpc-user&#39;
config.passwd = &#39;rpc-password&#39;
config.wallet = &quot;default&quot;
    [...]
</pre></div>
</div>
<p>If you don&#8217;t know what to do with these, you certainly shouldn&#8217;t run a witness
just now. Instead, read about [RPC and the
API](<a class="reference external" href="http://wiki.bitshares.org/index.php/BitShares/API">http://wiki.bitshares.org/index.php/BitShares/API</a>) of BitShares.
If you set up everything correctly, you may just run the python script and get
the private keys associated to a given account name and the correspoinding
balance::</p>
<div class="highlight-python"><div class="highlight"><pre>$ python getbalancekeys.py
accountA   5xxxxxxxxxxxxxxxxxxxxxxxxxx&lt;owner wif key&gt;           2750.00000 BTS
accountB   5xxxxxxxxxxxxxxxxxxxxxxxxxx&lt;owner wif key&gt;          11246.00000 BTS
accountB   5xxxxxxxxxxxxxxxxxxxxxxxxxx&lt;owner wif key&gt;          30000.00000 BROWNIE.PTS
accountB   5xxxxxxxxxxxxxxxxxxxxxxxxxx&lt;owner wif key&gt;            300.00000 USE
accountB   5xxxxxxxxxxxxxxxxxxxxxxxxxx&lt;owner wif key&gt;          65744.00000 NOTE
accountC   5xxxxxxxxxxxxxxxxxxxxxxxxxx&lt;owner wif key&gt;              3.00000 GOLD
[...]
accountA&#39;s owner key 5xxxxxxxxxxxxxxxxxxxxxxxxxx&lt;balance wif key&gt;  #
accountB&#39;s owner key 5xxxxxxxxxxxxxxxxxxxxxxxxxx&lt;balance wif key&gt;  #
accountC&#39;s owner key 5xxxxxxxxxxxxxxxxxxxxxxxxxx&lt;balance wif key&gt;  #
</pre></div>
</div>
<p>You will only need BTS balances and the one of your account owner keys in order
to become a witness.</p>
<p>## BitShares 2.0 network (or Graphene testnet)</p>
<p>We now have everything prepared to</p>
<ul class="simple">
<li>import an existing account into the testnet</li>
<li>redeem funds to register a witness in the testnet</li>
</ul>
<p>and we will now continue with the following steps:</p>
<ul class="simple">
<li>create a wallet for the testnet</li>
<li>import an account and funds</li>
<li>upgrade our account to a lifetime member</li>
<li>register a new witness</li>
<li>upvote the witness with our funds</li>
<li>sign blocks</li>
</ul>
<p>From this point on, we will no longer require interaction with BitShares 0.9.</p>
<p>### Download the genesis block (only for testnet)</p>
<p>For the testnet we need to download the proper genesis block. Eventually, the
genesis block will be part of the client so that this step will not be required
for the real network later. The genesis block can be downloaded (here)[<a class="reference external" href="https://drive.google.com/open?id=0B_GVo0GoC_v_S3lPOWlUbFJFWTQ">https://drive.google.com/open?id=0B_GVo0GoC_v_S3lPOWlUbFJFWTQ</a>].</p>
<p>### Run the witness as a node in the network
We first run the witness node without block production and connect it to the P2P
network with the following command::</p>
<div class="highlight-python"><div class="highlight"><pre>$ programs/witness_node/witness_node -s 104.200.28.117:61705 --rpc-endpoint 127.0.0.1:8090 --genesis-json aug-14-test-genesis.json
</pre></div>
</div>
<p>The address <cite>104.200.28.117</cite> is one of the public seed nodes.</p>
<p>### Creating a wallet
We now open up the cli_wallet and connect to our plain and stupid witness
node::</p>
<div class="highlight-python"><div class="highlight"><pre>$ programs/cli_wallet/cli_wallet -s ws://127.0.0.1:8090
</pre></div>
</div>
<p>First thing to do is setting up a password for the newly created wallet prior to
importing any private keys::</p>
<div class="highlight-python"><div class="highlight"><pre>new &gt;&gt;&gt; set_password &lt;password&gt;
null
locked &gt;&gt;&gt; unlock &lt;password&gt;
null
unlocked &gt;&gt;&gt;
</pre></div>
</div>
<p>Wallet creation is now done.</p>
<p>### Basic Account Management
We can import the account name (owner key) and the balance containing keys into
BitShares 2.0::</p>
<div class="highlight-python"><div class="highlight"><pre>unlocked &gt;&gt;&gt; import_key &lt;accountname&gt; &lt;owner wif key&gt;
true
unlocked &gt;&gt;&gt; import_balance &lt;accountname&gt; [&lt;balance wif key&gt;] true
[a transaction in json format]
unlocked &gt;&gt;&gt; list_my_accounts
[{
&quot;id&quot;: &quot;1.2.15&quot;,
...
&quot;name&quot;: &lt;accountname&gt;,
...
]
unlocked &gt;&gt;&gt; list_account_balances &lt;accountname&gt;
XXXXXXX BTS
</pre></div>
</div>
<p>Note: Make sure to put the []-brackets around the private key, since the import
method takes an array of keys.</p>
<p>In case your account&#8217;s owner key is different from its active key, make sure you import it into BitShares 2.0 as well.</p>
<p>Since only lifetime members can become witnesses, you must first upgrade to a
lifetime member. This step costs the lifetime-upgrade fee which will eventually
cost about $100:</p>
<div class="highlight-python"><div class="highlight"><pre>unlocked &gt;&gt;&gt; upgrade_account &lt;accountname&gt; true
[a transaction in json format]
</pre></div>
</div>
<p>### Becoming a Witness
To become a witness and be able to produce blocks, you first need to create a
witness object that can be voted in.</p>
<p>Note: If you want to experiment with things that require voting, be aware that
votes are only tallied once per day at the maintenance interval.
<cite>get_dynamic_global_properties</cite> tells us when that will be in
<cite>next_maintenance_time</cite>. Once the next maintenance interval passes, run
<cite>get_global_properties</cite> again and you should see that your new witness has been
voted in.</p>
<p>Before we get started, we can see the current list of witnesses voted in, which
will simply be the ten default witnesses::</p>
<div class="highlight-python"><div class="highlight"><pre>unlocked &gt;&gt;&gt; get_global_properties
...
  &quot;active_witnesses&quot;: [
&quot;1.6.0&quot;,
&quot;1.6.1&quot;,
&quot;1.6.2&quot;,
&quot;1.6.3&quot;,
&quot;1.6.4&quot;,
&quot;1.6.5&quot;,
&quot;1.6.6&quot;,
&quot;1.6.7&quot;,
&quot;1.6.8&quot;,
&quot;1.6.9&quot;
  ],
...

unlocked &gt;&gt;&gt; create_witness &lt;accountname&gt; &quot;url-to-proposal&quot; true
{
  &quot;ref_block_num&quot;: 139,
  &quot;ref_block_prefix&quot;: 3692461913,
  &quot;relative_expiration&quot;: 3,
  &quot;operations&quot;: [[
  21,{
    &quot;fee&quot;: {
      &quot;amount&quot;: 0,
      &quot;asset_id&quot;: &quot;1.3.0&quot;
    },
    &quot;witness_account&quot;: &quot;1.2.16&quot;,
    &quot;url&quot;: &quot;url-to-proposal&quot;,
    &quot;block_signing_key&quot;: &quot;PUBLIC KEY&quot;,
    &quot;initial_secret&quot;: &quot;00000000000000000000000000000000000000000000000000000000&quot;
  }
]
  ],
  &quot;signatures&quot;: [
  &quot;1f2ad5597af2ac4bf7a50f1eef2db49c9c0f7616718776624c2c09a2dd72a0c53a26e8c2bc928f783624c4632924330fc03f08345c8f40b9790efa2e4157184a37&quot;
  ]
}
</pre></div>
</div>
<p>Our witness is registered, but it can&#8217;t produce blocks because nobody has voted
it in.  You can see the current list of active witnesses with
<cite>get_global_properties</cite>::</p>
<div class="highlight-python"><div class="highlight"><pre>unlocked &gt;&gt;&gt; get_global_properties
{
  &quot;active_witnesses&quot;: [
&quot;1.6.0&quot;,
&quot;1.6.1&quot;,
&quot;1.6.2&quot;,
&quot;1.6.3&quot;,
&quot;1.6.4&quot;,
&quot;1.6.5&quot;,
&quot;1.6.7&quot;,
&quot;1.6.8&quot;,
&quot;1.6.9&quot;
  ],
  ...
</pre></div>
</div>
<p>Now, we should vote our witness in.  Vote all of the shares in both
<cite>&lt;accountname&gt;</cite> and <cite>nathan</cite> in favor of your new witness.:</p>
<div class="highlight-python"><div class="highlight"><pre>unlocked &gt;&gt;&gt; vote_for_witness &lt;accountname&gt; &lt;accountname&gt; true true
[a transaction in json format]
</pre></div>
</div>
<p>Now we wait until the next maintenance interval.</p>
<p>Get the witness object using <cite>get_witness</cite> and take note of two things. The
<cite>id</cite> is displayed in <cite>get_global_properties</cite> when the witness is voted in, and
we will need it on the <cite>witness_node</cite> command line to produce blocks.  We&#8217;ll
also need the public <cite>signing_key</cite> so we can look up the correspoinding private
key.</p>
<p>Once we have that, run <cite>dump_private_keys</cite> which lists the public-key
private-key pairs to find the private key.</p>
<p>Warning: <cite>dump_private_keys</cite> will display your keys unencrypted on the
terminal, don&#8217;t do this with someone looking over your shoulder.:</p>
<div class="highlight-python"><div class="highlight"><pre>unlocked &gt;&gt;&gt; get_witness &lt;accountname&gt;
{
  [...]
  &quot;id&quot;: &quot;1.6.10&quot;,
  &quot;signing_key&quot;: &quot;GPH7vQ7GmRSJfDHxKdBmWMeDMFENpmHWKn99J457BNApiX1T5TNM8&quot;,
  [...]
}
</pre></div>
</div>
<p>The <cite>id</cite> and the <cite>signing_key</cite> are the two important parameters, here. Let&#8217;s get
the private key for that signing key with::</p>
<div class="highlight-python"><div class="highlight"><pre>unlocked &gt;&gt;&gt; dump_private_keys
[[
  ...
  ],[
&quot;GPH7vQ7GmRSJfDHxKdBmWMeDMFENpmHWKn99J457BNApiX1T5TNM8&quot;,
&quot;5JGi7DM7J8fSTizZ4D9roNgd8dUc5pirUe9taxYCUUsnvQ4zCaQ&quot;
  ]
]
</pre></div>
</div>
<p>Now we need to start the witness, so shut down the wallet (ctrl-d),  and shut
down the witness (ctrl-c).  Re-launch the witness, now mentioning the new
witness 1.6.10 and its keypair::</p>
<div class="highlight-python"><div class="highlight"><pre>./witness_node --rpc-endpoint=127.0.0.1:8090 --witness-id &#39;&quot;1.6.10&quot;&#39; --private-key &#39;[&quot;GPH7vQ7GmRSJfDHxKdBmWMeDMFENpmHWKn99J457BNApiX1T5TNM8&quot;, &quot;5JGi7DM7J8fSTizZ4D9roNgd8dUc5pirUe9taxYCUUsnvQ4zCaQ&quot;]&#39; --genesis-json aug-14-test-genesis.json -s 104.200.28.117:61705
</pre></div>
</div>
<p>Alternatively, you can also add this line into yout config.ini::</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">witness</span><span class="o">-</span><span class="nb">id</span> <span class="o">=</span> <span class="s">&quot;1.6.10&quot;</span>
<span class="n">private</span><span class="o">-</span><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;GPH7vQ7GmRSJfDHxKdBmWMeDMFENpmHWKn99J457BNApiX1T5TNM8&quot;</span><span class="p">,</span><span class="s">&quot;5JGi7DM7J8fSTizZ4D9roNgd8dUc5pirUe9taxYCUUsnvQ4zCaQ&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note: Make sure to use YOUR public/private keys instead of the once given above!</p>
<p>If you monitor the output of the <cite>witness_node</cite>, you should see it generate
blocks signed by your witness::</p>
<div class="highlight-python"><div class="highlight"><pre>Witness 1.6.10 production slot has arrived; generating a block now...
Generated block #367 with timestamp 2015-07-05T20:46:30 at time 2015-07-05T20:46:30
</pre></div>
</div>


  </div>
 </div>

 <script>var HN=[];HN.factory=function(e){return function(){HN.push([e].concat(Array.prototype.slice.call(arguments,0)))};},HN.on=HN.factory("on"),HN.once=HN.factory("once"),HN.off=HN.factory("off"),HN.emit=HN.factory("emit"),HN.load=function(){var e="hn-button.js";if(document.getElementById(e))return;var t=document.createElement("script");t.id=e,t.src="//hn-button.herokuapp.com/hn-button.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},HN.load();</script>
 </body>
</html>